let canvas=document.querySelector(".canvas");window.addEventListener("resize",()=>{canvas.setAttribute("width",window.getComputedStyle(canvas).getPropertyValue("width")),canvas.setAttribute("height",window.getComputedStyle(canvas).getPropertyValue("height")),mainFunc()}),document.addEventListener("DOMContentLoaded",()=>{canvas.setAttribute("width",window.getComputedStyle(canvas).getPropertyValue("width")),canvas.setAttribute("height",window.getComputedStyle(canvas).getPropertyValue("height")),mainFunc()});let ctx=canvas.getContext("2d"),pi=Math.PI;function clean(){ctx.fillStyle=window.getComputedStyle(canvas).getPropertyValue("background-color"),ctx.clearRect(0,0,canvas.width,canvas.height)}var timer,mas=[],mas2=[],generalMass=[],Sw=10,Sh=10,nw=canvas.width/Sw,nh=canvas.height/Sh,count=0,logString="",number=1,writtenMessage=!1;function cleanField(){for(let e=0;e<Sh;e++)for(let t=0;t<Sw;t++)1==mas[e][t]&&(ctx.fillStyle="#ffffff",ctx.fillRect(t*nw,e*nh,nw,nh),mas[e][t]=0);clean(),document.querySelector(".count").innerHTML=0,count=0,number=1,clearTimeout(timer),generalMass=[],document.querySelector(".answer").innerHTML='<span style="color: #000000">Not answer.</span>',writtenMessage=!1}function cloneMass(e,t){t=[];for(let n=0;n<e.length;n++){t[n]=[];for(let a=0;a<e[n].length;a++)t[n][a]=e[n][a]}}function startLife(){document.querySelector(".answer").innerHTML='<span style="color: #000000">Not answer.</span>',mas2=[];for(let t=0;t<Sh;t++){mas2[t]=[];for(let n=0;n<Sw;n++){var e=0;switch(1==mas[checkTop(t)-1][n]&&e++,1==mas[t][checkRight(n)+1]&&e++,1==mas[checkBottom(t)+1][n]&&e++,1==mas[t][checkLeft(n)-1]&&e++,mas[checkTop(t)-1][checkRight(n)+1]&&e++,mas[checkBottom(t)+1][checkRight(n)+1]&&e++,mas[checkBottom(t)+1][checkLeft(n)-1]&&e++,mas[checkTop(t)-1][checkLeft(n)-1]&&e++,e){case 2:0==mas[t][n]?mas2[t][n]=0:mas2[t][n]=1;break;case 3:mas2[t][n]=1;break;default:mas2[t][n]=0}}}if(mas=mas2,drawField(),isNullMass(generalMass[generalMass.length-1]))return document.querySelector(".answer").innerHTML="Stoped. The Life is dead.",void clearTimeout(timer);if(!writtenMessage)for(let e=0;e<generalMass.length;e++)if(equalMass(generalMass[e],mas))return writtenMessage=!0,document.querySelector(".answer").innerHTML="Stoped. Pattern repeated. Click Play to continue.",count++,void clearTimeout(timer);count++,generalMass[count]=mas,document.querySelector(".count").innerHTML=count,timer=setTimeout(startLife,100)}function checkTop(e){return 0==e?Sh:e}function checkRight(e){return e==Sw-1?-1:e}function checkBottom(e){return e==Sh-1?-1:e}function checkLeft(e){return 0==e?Sw:e}function drawField(){clean();for(let e=0;e<Sh;e++)for(let t=0;t<Sw;t++)1==mas[e][t]&&(ctx.fillStyle="#000000",ctx.fillRect(t*nw,e*nh,nw,nh))}function equalMass(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){if(e[n].length!=t[n].length)return!1;for(let a=0;a<e[n].length;a++)if(e[n][a]!=t[n][a])return!1}return!0}function isNullMass(e){for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)if(0!=e[t][n])return!1;return!0}function randomLife(){for(let e=0;e<Sh;e++){mas[e]=[];for(let t=0;t<Sw;t++)mas[e][t]=Math.round(Math.random())}drawField(),generalMass[0]=mas}function mainFunc(){for(let e=0;e<Sh;e++){mas[e]=[];for(let t=0;t<Sw;t++)mas[e][t]=0}canvas.onclick=function(e){var t=e.offsetX,n=e.offsetY;t=Math.floor(t/nw),n=Math.floor(n/nh),1==mas[n][t]?mas[n][t]=0:mas[n][t]=1,drawField(),generalMass[0]=mas}}